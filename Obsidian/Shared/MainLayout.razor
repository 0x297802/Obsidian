@using Obsidian.Data;
@inherits LayoutComponentBase

<style>
    .main-content-vertical {
        height: 100%;
        margin-left: 75px !important;
        padding-top: 0px !important;
    }

    .logo-image {
        width: 50px;
        border-radius: 25%;
        transition: box-shadow 250ms, width 100ms;
    }

        .logo-image:hover {
            width: 51px;
            box-shadow: 0px 0px 8px rgba(0,0,0,4);
        }
</style>

<MudThemeProvider IsDarkMode Theme="AppTheme.Theme" />
<MudDialogProvider />
<MudSnackbarProvider />
<HashtableProvider OnLoadingStart="OnHashtableLoadingStart" OnLoadingFinished="OnHashtableLoadingFinished" />

<MudLayout>
    <MudDrawer Open
               Style="width: 75px;"
               Elevation="2">
        <MudStack Class="py-2" Style="height: 100%"
                  AlignItems="AlignItems.Center">
            <MudImage Class="logo-image"
                      Elevation="6"
                      ObjectFit="ObjectFit.ScaleDown"
                      Src="images/obsidian_logonew_256.png" Alt="Obsidian logo" />
            <MudSpacer />
            <MudStack Spacing="2">
                <MudTooltip Text="Settings" Color="Color.Dark" Placement="Placement.Right">
                    <MudIconButton Icon="@Icons.Material.TwoTone.Settings" Color="Color.Inherit" Size="Size.Large"
                                   Variant="Variant.Filled" />
                </MudTooltip>
                <MudTooltip Text="Go to GitHub" Color="Color.Dark" Placement="Placement.Right">
                    <MudIconButton Icon="@Icons.Custom.Brands.GitHub" Color="Color.Inherit" Size="Size.Large"
                                   Variant="Variant.Filled"
                                   Href="https://github.com/Crauzer/Obsidian" Target="_blank" />
                </MudTooltip>
            </MudStack>
        </MudStack>
    </MudDrawer>
    <MudMainContent Class="main-content-vertical">
        @Body
    </MudMainContent>
    <MudOverlay DarkBackground Visible="_isLoadingHashtable" ZIndex="9999">
        <MudStack AlignItems="AlignItems.Center">
            <MudProgressCircular Indeterminate Color="Color.Primary" Size="Size.Large" />
            <MudText Typo="Typo.h5">Syncing hashtables from CDragon...</MudText>
        </MudStack>
    </MudOverlay>
</MudLayout>

@code {
    private bool _isLoadingHashtable;

    private void OnHashtableLoadingStart()
    {
        this._isLoadingHashtable = true;
    }

    private void OnHashtableLoadingFinished()
    {
        this._isLoadingHashtable = false;
    }
}
